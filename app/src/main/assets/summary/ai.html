<!--
  ~ Copyright (C) 2026 ankio(ankio@ankio.net)
  ~ Licensed under the Apache License, Version 3.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~         http://www.apache.org/licenses/LICENSE-3.0
  ~
  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~   limitations under the License.
  -->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI è´¢åŠ¡æŠ¥å‘Šé£æ ¼æ•´åˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        /* é€šç”¨è‰²æ¿ï¼šé»˜è®¤ä¸»é¢˜è‰²ï¼Œæ”¯æŒå¤–éƒ¨æ³¨å…¥è¦†ç›– */
        :root {
            --color-bg-page: #f1f5f9;
            --color-surface-1: #f8fafc;
            --color-surface-2: #ffffff;
            --color-surface-1-dark: #0f172a;
            --color-surface-2-dark: #1e293b;
            --color-text-title: #1f2937;
            --color-text-body: #334155;
            --color-text-muted: #475569;
            --color-text-subtle: #4b5563;
            --color-primary: #6366f1;
            --color-primary-dark: #818cf8;
            --color-secondary: #94a3b8;
            --color-secondary-dark: #64748b;
            --color-success: #22c55e;
            --color-success-deep: #059669;
            --color-danger: #ef4444;
            --color-warning: #f59e0b;
            --color-warning-deep: #d97706;
            --color-info: #2563eb;
            --color-warning-text: #ea580c;
            --color-tag-bg: #f3f4f6;
            --color-tag-success-bg: #ecfdf5;
            --color-tag-info-bg: #eff6ff;
            --color-alert-bg: #fff7ed;
            --color-alert-border: #ffedd5;
            --color-alert-text: #9a3412;
            --color-gradient-start: #4f46e5;
            --color-gradient-end: #7c3aed;
            --color-black-rgb: 0, 0, 0;
            --color-white-rgb: 255, 255, 255;
            --color-primary-rgb: 99, 102, 241;
            --color-warning-deep-rgb: 217, 119, 6;
        }
        /* é€šç”¨é¡µé¢ç»“æ„ä¸åˆ†åŒºæ ‡è¯† */
        body { margin: 0; font-family: 'Segoe UI', system-ui, sans-serif; }
        .page { padding: 20px 0 40px; }
        .theme { padding: 25px 0; }
        .theme-title {
            max-width: 1000px; margin: 0 auto 12px; padding: 0 20px;
            font-size: 16px; font-weight: 700; color: var(--color-text-title);
        }

        /* ä¸»é¢˜ä¸€ï¼šå…¨æ™¯é€è§†é£æ ¼æ ·å¼ */
        .theme-1 {
            --card: var(--color-surface-2);
            --primary: var(--color-primary);
            --secondary: var(--color-secondary);
            --success: var(--color-success);
            --danger: var(--color-danger);
            --warning: var(--color-warning);
            color: var(--color-text-body);
        }
        @media (prefers-color-scheme: dark) {
            .theme-1 {
                --card: var(--color-surface-2-dark);
                --primary: var(--color-primary-dark);
                --secondary: var(--color-secondary-dark);
            }
        }
        .theme-1 .container { max-width: 1000px; margin: 0 auto; padding: 25px; }
        /* Theme-1 layout: mobile-first stacked flow */
        .theme-1 .grid { display: flex; flex-direction: column; gap: 20px; }
        /* Theme-1 shared card base */
        .theme-1 .card { background: var(--card); border-radius: 24px; padding: 25px; box-shadow: 0 10px 25px rgba(var(--color-black-rgb), 0.05); }
        .theme-1 .header-card { background: linear-gradient(135deg, var(--color-gradient-start) 0%, var(--color-gradient-end) 100%); color: white; }
        /* Theme-1 header layout */
        .theme-1 .header-row { display: flex; justify-content: space-between; align-items: flex-start; }
        .theme-1 .header-title { margin: 10px 0; }
        .theme-1 .header-desc { opacity: 0.8; max-width: 600px; }
        .theme-1 .header-score { text-align: right; }
        .theme-1 .header-score-label { font-size: 12px; opacity: 0.8; }
        .theme-1 .header-score-value { font-size: 64px; font-weight: 900; }
        /* Theme-1 spacing helpers */
        .theme-1 .grid-top { margin-top: 20px; }
        .theme-1 .grid-main { margin-top: 20px; }
        /* Theme-1 stat blocks */
        .theme-1 .stat-label { color: var(--secondary); font-size: 13px; }
        .theme-1 .stat-val { font-size: 28px; font-weight: 800; margin: 5px 0; }
        .theme-1 .stat-val-primary { color: var(--primary); }
        .theme-1 .stat-val-danger { color: var(--danger); }
        .theme-1 .stat-val-warning { color: var(--warning); }
        .theme-1 .stat-note { font-size: 12px; }
        .theme-1 .stat-note-success { color: var(--success); }
        .theme-1 .stat-note-warning { color: var(--warning); }
        .theme-1 .stat-note-muted { color: var(--color-text-muted); }
        .theme-1 .chart { width: 100%; height: 350px; }
        .theme-1 .badge { padding: 4px 12px; border-radius: 20px; font-size: 12px; background: rgba(var(--color-white-rgb), 0.2); }
        .theme-1 .ai-text { font-size: 14px; line-height: 1.6; border-left: 3px solid var(--primary); padding-left: 15px; margin: 15px 0; }
        /* Theme-1 section titles */
        .theme-1 .section-title { font-size: 18px; font-weight: 700; color: var(--primary); margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .theme-1 .section-title-warning { color: var(--warning); }
        .theme-1 .section-title-success { color: var(--success); }
        /* Theme-1 paragraph blocks */
        .theme-1 .analysis-text { color: var(--color-text-muted); font-size: 14px; text-align: justify; margin-bottom: 15px; line-height: 1.6; }
        .theme-1 .analysis-text b { color: var(--primary); }
        .theme-1 .insight-box { background: rgba(var(--color-primary-rgb), 0.05); border-radius: 12px; padding: 15px; border-left: 4px solid var(--primary); margin-top: 10px; }
        /* Theme-1 insight variants */
        .theme-1 .insight-warning { background: rgba(var(--color-warning-deep-rgb), 0.05); border-left-color: var(--warning); }
        /* Theme-1 tags and analysis blocks */
        .theme-1 .tag { padding: 4px 12px; border-radius: 100px; font-size: 12px; background: var(--color-tag-bg); color: var(--color-text-subtle); font-weight: 500; }
        .theme-1 .tag-row { display: flex; justify-content: center; gap: 10px; }
        .theme-1 .tag-success { background: var(--color-tag-success-bg); color: var(--color-success-deep); }
        .theme-1 .tag-info { background: var(--color-tag-info-bg); color: var(--color-info); }
        .theme-1 .tag-warning { background: var(--color-alert-bg); color: var(--color-warning-text); }
        .theme-1 .analysis-section h3 { font-size: 18px; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
        .theme-1 .analysis-subtitle { font-weight: 700; font-size: 14px; margin-bottom: 8px; }
        .theme-1 .analysis-p { font-size: 14px; line-height: 1.8; color: var(--color-text-subtle); margin-bottom: 15px; text-align: justify; }
        .theme-1 .highlight { color: var(--color-primary); font-weight: 600; }
        .theme-1 .warning-box { background: var(--color-alert-bg); border: 1px solid var(--color-alert-border); padding: 15px; border-radius: 12px; color: var(--color-alert-text); font-size: 13px; }
        .theme-1 .chart-box { height: 300px; width: 100%; margin: 20px 0; }
        /* Theme-1 card modifiers */
        .theme-1 .card-warning-bottom { border-bottom: 5px solid var(--warning); }
        .theme-1 .card-warning-left { border-left: 6px solid var(--warning); }
        .theme-1 .card-title-primary { color: var(--primary); }
        .theme-1 .card-title-compact { margin-top: 0; font-size: 16px; }
        /* Theme-1 inner panels and lists */
        .theme-1 .risk-panel { background: rgba(var(--color-primary-rgb), 0.03); border-radius: 15px; padding: 15px; }
        .theme-1 .risk-list { font-size: 13px; color: var(--color-text-muted); padding-left: 20px; }
        /* Theme-1 action list */
        .theme-1 .action-list { font-size: 13px; color: var(--color-text-muted); padding-left: 20px; }
        .theme-1 .action-list b { color: var(--primary); }
        /* Theme-1 responsive layout */
        @media (max-width: 900px) {
            /* Mobile: add spacing between major sections */
            .theme-1 .grid-main { margin-top: 28px; }
            /* Mobile: header stacks vertically */
            .theme-1 .header-row { flex-direction: column; gap: 12px; }
            .theme-1 .header-score { text-align: left; }
            .theme-1 .header-score-value { font-size: 48px; }
            /* Mobile: compact charts and tags */
            .theme-1 .chart { height: 260px; }
            .theme-1 .chart-box { height: 240px; }
            .theme-1 .tag-row { flex-wrap: wrap; }
        }
        
        /* é¡µé¢å¤´éƒ¨å’Œåº•éƒ¨ */
        .page-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 24px 20px 12px;
            max-width: 1000px;
            margin: 0 auto;
        }
        .page-logo {
            width: 28px;
            height: 28px;
            border-radius: 6px;
        }
        .page-logo-emoji {
            font-size: 20px;
            line-height: 1;
        }
        .page-header-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--color-text-title);
            margin: 0;
        }
        .page-footer {
            text-align: center;
            padding: 24px 20px;
            color: var(--color-text-muted);
            font-size: 14px;
            max-width: 1000px;
            margin: 0 auto;
        }
        @media (prefers-color-scheme: dark) {
            .page-header-title {
                color: #e5e7eb;
            }
        }
    </style>
</head>
<body>
<div class="page">
    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="page-header">
        <div class="page-logo" id="pageLogo"></div>
        <p class="page-header-title" id="pageHeaderTitle">è‡ªåŠ¨è®°è´¦ â€¢ è´¢åŠ¡åˆ†æ</p>
    </div>
    <!-- ä¸»é¢˜ä¸€å†…å®¹ï¼šå…¨æ™¯é€è§†é£æ ¼ -->
    <section class="theme theme-1">
        <div class="container">
            <!-- æŠ¥å‘Šå¤´éƒ¨ï¼šèº«ä»½ä¸è¯„åˆ†æ¦‚è§ˆ -->
            <div class="card header-card">
                <div class="header-row">
                    <div>
                        <span class="badge" id="identityBadge"></span>
                        <h1 class="header-title" id="reportTitle"></h1>
                        <p class="header-desc" id="headerDesc"></p>
                    </div>
                    <div class="header-score">
                        <div class="header-score-label" id="healthScoreLabel"></div>
                        <div class="header-score-value" id="healthScore"></div>
                    </div>
                </div>
            </div>

            <!-- æ ¸å¿ƒæŒ‡æ ‡ï¼šæ”¶æ”¯ä¸æ³¢åŠ¨ -->
            <div class="grid grid-top">
                <div class="card">
                    <div class="stat-label" id="incomeLabel"></div>
                    <div class="stat-val stat-val-primary" id="totalIncome"></div>
                    <div class="stat-note stat-note-success" id="savingsNote"></div>
                </div>
                <div class="card">
                    <div class="stat-label" id="expenseLabel"></div>
                    <div class="stat-val stat-val-danger" id="totalExpense"></div>
                    <div class="stat-note stat-note-warning" id="maxSingleNote"></div>
                </div>
                <div class="card card-warning-bottom">
                    <div class="stat-label" id="outlierLabel"></div>
                    <div class="stat-val stat-val-warning" id="outlierIndex"></div>
                    <div class="stat-note stat-note-muted" id="outlierDesc"></div>
                </div>
            </div>

            <!-- æŠ¥å‘Šä¸»ä½“ï¼šæ¨¡å—åŒ–ç»“æ„ -->
            <div class="grid grid-main">
                <!-- æ¶ˆè´¹ç»“æ„æ¨¡å—ï¼ˆæ ‘å›¾ + ç»“æ„æè¿°ï¼‰ -->
                <div class="card">
                    <h3 class="card-title-primary" id="consumeTitle"></h3>
                    <div id="treeChart1" class="chart"></div>
                    <div class="ai-text" id="consumeAnalysis1"></div>
                    <div class="ai-text" id="consumeAnalysis2"></div>
                </div>

                <!-- ç»“æ„ç”»åƒæ¨¡å—ï¼ˆé›·è¾¾ï¼šç¨³å®š/è‡ªå¾‹/æŠ•èµ„/é£é™©ï¼‰ -->
                <div class="card">
                    <h3 id="radarTitle"></h3>
                    <div id="radarChart1" class="chart"></div>
                </div>

                <!-- å¼‚å¸¸é£é™©æ¨¡å—ï¼ˆç‹¬ç§€æŒ‡æ•° + å¼‚å¸¸ä¿¡å·ï¼‰ -->
                <section class="card card-warning-left">
                    <div class="section-title section-title-warning" id="riskTitle"></div>
                    <div class="analysis-text" id="outlierAnalysis"></div>
                    <div class="analysis-text" id="largeTransactionAnalysis"></div>
                    <div class="analysis-text" id="latteFactorAnalysis"></div>
                </section>

                <!-- æ¶ˆè´¹ç”»åƒæ¨¡å—ï¼ˆåå¥½ + æ—¶é—´è§„å¾‹ï¼‰ -->
                <section class="card">
                    <div class="section-title" id="behaviorTitle"></div>
                    <div class="grid">
                        <div>
                            <p class="analysis-subtitle" id="preferenceSubtitle"></p>
                            <div class="analysis-text" id="preferenceAnalysis"></div>
                        </div>
                        <div>
                            <p class="analysis-subtitle" id="timePatternSubtitle"></p>
                            <div class="analysis-text" id="timePatternAnalysis"></div>
                        </div>
                    </div>
                </section>

                <!-- ç»¼åˆç»“è®ºæ¨¡å—ï¼ˆå¥åº·ç­‰çº§ + æ ‡ç­¾ï¼‰ -->
                <section class="card">
                    <div class="section-title" id="conclusionTitle"></div>
                    <div class="analysis-text" id="conclusion1"></div>
                    <div class="analysis-text" id="conclusion2"></div>
                    <div class="insight-box" id="expertSummary"></div>
                    <div id="radarChart3" class="chart-box"></div>
                    <div class="tag-row" id="tagRow"></div>
                </section>

                <!-- è¡ŒåŠ¨æ¸…å•æ¨¡å—ï¼ˆå¯æ‰§è¡Œé¡¹ï¼‰ -->
                <section class="card analysis-section">
                    <div class="section-title section-title-success" id="actionTitle"></div>
                    <p class="analysis-text" id="actionIntro"></p>
                    <ul class="action-list" id="actionList"></ul>
                    <h3 id="executionTitle"></h3>
                    <p class="analysis-p" id="executionPriority"></p>
                    <h3 id="recordQualityTitle"></h3>
                    <p class="analysis-p" id="recordQuality"></p>
                    <div class="warning-box" id="warningBox"></div>
                </section>
            </div>
        </div>
    </section>

    <!-- é¡µé¢åº•éƒ¨ -->
    <div class="page-footer" id="pageFooter">
        ç”±è‡ªåŠ¨è®°è´¦ç”Ÿæˆ
    </div>
</div>

<script>
    // ==========================================================
    // é»˜è®¤æ•°æ®ç»“æ„ - æ‰€æœ‰æ•°æ®é›†ä¸­å®šä¹‰
    // ==========================================================
    const defaultData = {
        // é¡µé¢å¤´éƒ¨å’Œåº•éƒ¨
        logoBase64: "",
        pageHeaderTitle: "è‡ªåŠ¨è®°è´¦ â€¢ è´¢åŠ¡åˆ†æ",
        pageFooter: "ç”±è‡ªåŠ¨è®°è´¦ç”Ÿæˆ",
        
        // é¡µé¢æ ‡é¢˜å’Œæ ‡ç­¾
        reportTitle: "è´¢åŠ¡å…¨æ™¯é€è§†æŠ¥å‘Š",
        healthScoreLabel: "AI è´¢åŠ¡å¥åº·åˆ†",
        incomeLabel: "æ€»æ”¶å…¥ (å«å·¥èµ„/ç†è´¢)",
        expenseLabel: "æœ¬æœˆæ€»æ”¯å‡º",
        outlierLabel: "ç‹¬ç§€æŒ‡æ•° (Outlier)",
        outlierDesc: "æ”¯å‡ºæ¨¡å¼å­˜åœ¨æ˜æ˜¾æ³¢åŠ¨",
        
        // ç« èŠ‚æ ‡é¢˜
        consumeTitle: "ğŸ§© æ¶ˆè´¹ç»“æ„åˆ†æ",
        radarTitle: "ğŸš€ ç»“æ„ç”»åƒé›·è¾¾",
        riskTitle: "<span>âš ï¸</span> å¼‚å¸¸é£é™©",
        behaviorTitle: "ğŸ” æ¶ˆè´¹ç”»åƒä¸è¡Œä¸ºè§„å¾‹",
        conclusionTitle: "<span>âš–ï¸</span> ç»¼åˆç»“è®ºä¸å¥åº·ç­‰çº§",
        actionTitle: "<span>âœ…</span> è¡ŒåŠ¨æ¸…å•",
        executionTitle: "âœ… æ‰§è¡Œä¼˜å…ˆçº§",
        recordQualityTitle: "ğŸ§­ è®°å½•è´¨é‡æå‡",
        
        // å­æ ‡é¢˜
        preferenceSubtitle: "ğŸ¯ æ½œåœ¨åå¥½ï¼šæŠ€èƒ½æ ‘æŠ•èµ„",
        timePatternSubtitle: "ğŸ•°ï¸ æ—¶é—´è§„å¾‹ï¼šæ·±å¤œå†³ç­–é£é™©",
        
        // åŸºç¡€ä¿¡æ¯
        identity: "æŠ€æœ¯å‹è¿›å–è€…",
        period: "xxxå‘¨æœŸ",
        totalExpenseInDesc: "12,450",
        headerDescription: "åŸºäºxxxå‘¨æœŸå†… <strong>Â¥12,450</strong> æ”¯å‡ºæµå‘ï¼ŒAI è¯†åˆ«å‡ºä½ æ­£å¤„äºã€ŒæŠ€èƒ½è·ƒè¿ã€ä¸ã€Œå¥åº·é‡å¡‘ã€çš„åŒé‡æˆé•¿æœŸã€‚",
        healthScore: 89,
        
        // æ”¶å…¥æ•°æ®
        totalIncome: 18500.00,
        savingsRate: 32.7,
        savingsStatus: "å¥åº·",
        
        // æ”¯å‡ºæ•°æ®
        totalExpense: 12450.41,
        maxSingleAmount: 5600,
        maxSingleCategory: "æ‘„å½±å™¨æ",
        outlierIndex: 76,
        
        // æ¶ˆè´¹ç»“æ„åˆ†ææ–‡æœ¬
        consumeAnalysis1: "<strong>ã€æ‘„å½±ä¸è‡ªæˆ‘æŠ•èµ„ã€‘</strong><br>æœ¬æœˆæ‘„å½±å™¨ææ”¯å‡ºå æ€»å¼€æ”¯çš„ 45%ã€‚ä½œä¸ºä¸€ç§ã€Œæ˜‚è´µçš„çˆ±å¥½ã€ï¼ŒAI å»ºè®®å°†å…¶æ‘Šé”€åˆ°æœªæ¥ 12 ä¸ªæœˆåˆ†æã€‚ä½ å¯¹ä¸“ä¸šå·¥å…·çš„è¿½æ±‚ä¸ä½ åœ¨ SOC åä½œä¸­å¯¹ç»†èŠ‚çš„æŠŠæ§é€»è¾‘é«˜åº¦ä¸€è‡´ã€‚",
        consumeAnalysis2: "<strong>ã€é¥®é£Ÿå¥åº·åé¦ˆã€‘</strong><br>ç›‘æµ‹åˆ°ã€Œå…¨çƒ­é£Ÿè®¡åˆ’ã€æ‰§è¡Œè‰¯å¥½ï¼Œå¤–å–/å†·é£Ÿæ”¯å‡ºä¸‹é™ 40%ã€‚ä½†æœ¬æœˆè›‹ç™½è´¨é‡‡è´­ï¼ˆé‡Œè„Š/é¸¡è…¿ï¼‰æˆæœ¬å› èŠ‚å‡æ—¥ä¸Šå‡ï¼Œå»ºè®®å…³æ³¨ç”Ÿé²œå¹³å°çš„å‘¨æœŸæ€§ä¼˜æƒ ã€‚",
        
        // å¼‚å¸¸é£é™©åˆ†ææ–‡æœ¬
        outlierAnalysis: "<b>ç‹¬ç§€æŒ‡æ•°åˆ†æï¼š</b>æœ¬å‘¨æœŸè§¦å‘äº† <b>82%</b> çš„åç¦»é¢„è­¦ã€‚ä¸»è¦è¯±å› æ˜¯å‡ºç°ä¸€ç¬”é‡‘é¢æ˜æ˜¾é«˜äºå†å²å‡å€¼çš„äº¤æ˜“ï¼Œä¸”ä¸å¸¸è§„æ¶ˆè´¹èŠ‚å¥ä¸ä¸€è‡´ã€‚å»ºè®®å›çœ‹è¯¥ç¬”äº¤æ˜“çš„ç”¨é€”ä¸å¿…è¦æ€§ï¼Œç¡®è®¤æ˜¯å¦ä¸ºä¸€æ¬¡æ€§å¤§é¢æ”¯å‡ºæˆ–ä¸´æ—¶æ€§é¢„ç®—æ³¢åŠ¨ã€‚",
        largeTransactionAnalysis: "<b>å¤§é¢äº¤æ˜“åˆ†æï¼š</b>æœ¬å‘¨æœŸå‡ºç°ä¸€ç¬”é‡‘é¢ä¸º <b>Â¥5,600</b> çš„å•ç¬”äº¤æ˜“ï¼ˆå•†æˆ·ï¼šæ‘„å½±å™¨æè´­ç½®ï¼‰ã€‚è¯¥é‡‘é¢çº¦ä¸ºæœ¬æœˆå¹³å‡å•ç¬”æ”¯å‡ºçš„ <b>4.5 å€</b>ï¼Œä¸”å‘ç”Ÿåœ¨æœˆä¸­ï¼Œå¯¼è‡´å½“å‘¨å¯æ”¯é…é¢„ç®—æ˜æ˜¾æ”¶ç´§ã€‚å»ºè®®æ ‡è®°è¯¥ç¬”ä¸ºä¸€æ¬¡æ€§å¤§é¢é‡‡è´­ï¼Œå¹¶åœ¨ä¸‹å‘¨æœŸé¢„ç•™å¤§ä»¶é¢„ç®—ï¼Œé¿å…æŒ¤å‹æ—¥å¸¸æ”¯å‡ºã€‚",
        latteFactorAnalysis: "<b>æ‹¿é“å› å­è§‚å¯Ÿï¼š</b>æ£€æµ‹åˆ°ã€Œäº‘ç«¯å­˜å‚¨æœåŠ¡ã€æ¯æ—¥æ‰£è´¹ <b>Â¥18</b>ï¼Œå·²è¿ç»­å‡ºç° <b>92</b> å¤©ï¼Œç´¯è®¡çº¦ <b>Â¥1,656</b>ã€‚è‹¥ç»´æŒå½“å‰é¢‘ç‡ï¼Œå¹´åº¦æ”¯å‡ºå°†è¾¾ <b>Â¥6,570</b>ã€‚å»ºè®®æ ¸å¯¹æ˜¯å¦å­˜åœ¨é‡å¤è®¢é˜…æˆ–ä½ä½¿ç”¨ç‡æœåŠ¡ï¼Œå¹¶è®¾ç½®æœˆåº¦å°é¢è®¢é˜…ä¸Šé™ã€‚",
        
        // æ¶ˆè´¹ç”»åƒæ–‡æœ¬
        preferenceAnalysis: "é€šè¿‡å•†æˆ·è¯­ä¹‰åˆ†æï¼ŒAI å‘ç°ä½ æœ¬å‘¨æœŸåœ¨<b>æ•™è‚²ä¸å·¥å…·ç±»ï¼ˆå æ€»æ”¯å‡º 24.8%ï¼‰</b>ä¸Šçš„æŠ•å…¥å‘ˆç°é«˜é¢‘ç‰¹å¾ã€‚è¿™è¡¨æ˜ä½ å€¾å‘äºé€šè¿‡ä»˜è´¹è·å–æ—¶é—´æ•ˆç‡ï¼Œå±äºå…¸å‹çš„<b>ã€Œç”Ÿäº§åŠ›é©±åŠ¨å‹ã€</b>ç”»åƒã€‚",
        timePatternAnalysis: "çº¦æœ‰ 15% çš„éè®¡åˆ’æ¶ˆè´¹å‘ç”Ÿåœ¨ <b>23:00 ä»¥å</b>ã€‚å°½ç®¡å•ç¬”é‡‘é¢è¾ƒå°ï¼Œä½† AI å»ºè®®è­¦æƒ•ç”±äºç”Ÿç†æ€§ç–²åŠ³å¯¼è‡´çš„ã€Œå†²åŠ¨å‹ã€æ•°å­—è®¢é˜…ï¼Œè¿™ç±»æ”¯å‡ºå¾€å¾€å…·æœ‰æé«˜çš„é•¿æœŸéšå½¢æˆæœ¬ã€‚",
        
        // ç»¼åˆç»“è®ºæ–‡æœ¬
        conclusion1: "æœ¬å‘¨æœŸå†…ï¼Œä½ çš„è´¢åŠ¡ç³»ç»Ÿè¡¨ç°å‡ºæå¼ºçš„<b>ã€Œé˜²å¾¡æ€§æ‰©å¼ ã€</b>ç‰¹å¾ã€‚å°½ç®¡æ€»æ”¯å‡ºæœ‰æ‰€ä¸Šå‡ï¼Œä½†<b>æ ¸å¿ƒç›ˆä½™ç‡ï¼ˆ32.5%ï¼‰</b>ä»é«˜äºè¯¥èµ„äº§é‡çº§ç”¨æˆ·çš„å¹³å‡åŸºå‡†ã€‚AI ç›‘æµ‹åˆ°ä½ çš„æ¶ˆè´¹å†³ç­–è·¯å¾„æ­£åœ¨å‘ç”Ÿåç§»ï¼šä»è¿‡å»çš„ã€Œè¡¥å¿å‹æ¶ˆè´¹ã€è½¬å‘äº†å½“å‰çš„<b>ã€ŒæŠ•èµ„å‹æ¶ˆè´¹ã€</b>ã€‚",
        conclusion2: "ä½ çš„æ”¯å‡ºæ³¢åŠ¨ä¸»è¦é›†ä¸­åœ¨æœˆæœ«ï¼Œè¿™é€šå¸¸ä¸å›ºå®šå‘¨æœŸçš„è®¢é˜…è´¹ç”¨ç»“ç®—ç›¸å…³ã€‚å€¼å¾—è‚¯å®šçš„æ˜¯ï¼Œä½ åœ¨<b>éå¿…éœ€å“ï¼ˆå¦‚å¨±ä¹å¼€é”€ï¼‰</b>ä¸Šçš„è‡ªæ§åŠ›è¡¨ç°å“è¶Šï¼Œè¿™ç±»å¼€æ”¯ä»…å æ€»æ¯”çš„ 4.2%ã€‚",
        expertSummary: "<b>ğŸ’¡ ä¸“å®¶æ€»ç»“ï¼š</b>ä½ ç›®å‰çš„è´¢åŠ¡çŠ¶æ€éå¸¸å¥åº·ï¼ŒæŠ—é£é™©èƒ½åŠ›ç­‰çº§ä¸º <b>A-</b>ã€‚ç”±äºä½ çš„å›ºå®šæ”¯å‡ºå æ¯”æä½ï¼Œä½ æ‹¥æœ‰æå¤§çš„è´¢åŠ¡çµæ´»æ€§æ¥åº”å¯¹ä¸‹ä¸€å‘¨æœŸçš„çªå‘æ€§æŠ•å…¥ã€‚",
        
        // æ ‡ç­¾æ•°æ®
        tags: [
            { text: "ç¨³å®šæ€§ï¼šä¼˜", type: "success" },
            { text: "è‡ªå¾‹åº¦ï¼šä¼˜", type: "info" },
            { text: "é˜²å¾¡åŠ›ï¼šä¸€èˆ¬", type: "warning" }
        ],
        
        // è¡ŒåŠ¨æ¸…å•æ–‡æœ¬
        actionIntro: "æœ¬å‘¨æœŸå‘ˆç°ã€Œé«˜æ”¯å‡º + è®¢é˜…ç´¯ç§¯ + å¤§é¢é‡‡è´­ã€ä¸‰ç±»å‹åŠ›æºã€‚è¡ŒåŠ¨æ¸…å•ä»¥ã€Œå…ˆç¨³ç°é‡‘æµã€å†å‹å¯é€‰æ”¯å‡ºã€æœ€åè¡¥é½æ•°æ®ã€ä¸ºä¼˜å…ˆçº§ï¼Œé¿å…å› ä¿¡æ¯ä¸å®Œæ•´å¯¼è‡´è¯¯åˆ¤ã€‚",
        actions: [
            "<b>å‚¨è“„ä¼˜å…ˆï¼š</b>å°†æœ¬æœŸç›ˆä½™å…ˆåˆ’æ‹¨è‡³ç¼“å†²è´¦æˆ·ï¼Œç›®æ ‡æ˜¯ä¸ä½äºæœˆæ”¯å‡ºçš„ 15%ã€‚",
            "<b>æ§åˆ¶å¯é€‰æ¶ˆè´¹ï¼š</b>å¯¹é¤é¥®/ç¤¾äº¤è®¾å®šä¸Šé™ï¼Œè¿ç»­è¶…æ”¯ä¸¤å‘¨åˆ™é™ä½ä¸‹ä¸€å‘¨é¢„ç®— 10%ã€‚",
            "<b>å¤§é¢æ”¯å‡ºå½’ç±»ï¼š</b>å°†æœ¬æœŸå¤§é¢äº¤æ˜“æ ‡è®°ä¸ºã€Œä¸€æ¬¡æ€§/å¯å¤å‘ã€ï¼Œå¯å¤å‘ç±»éœ€åœ¨ä¸‹æœŸé¢„ç•™é¢„ç®—ã€‚",
            "<b>è®¢é˜…ç²¾ç®€ï¼š</b>åˆ—å‡ºå…¨éƒ¨è‡ªåŠ¨æ‰£è´¹æœåŠ¡ï¼Œä½ä½¿ç”¨ç‡é¡¹å…ˆæš‚åœ 1 ä¸ªå‘¨æœŸå†å†³å®šæ˜¯å¦ç»­è´¹ã€‚",
            "<b>æ”¶å…¥è¡¥å½•ï¼š</b>è¡¥è®°æœ€è¿‘ä¸€ç¬”å·¥èµ„æˆ–ä¸»è¦æ”¶å…¥ï¼Œæµ‹ç®—å¯æ”¯æ’‘æœˆæ•°ã€‚"
        ],
        executionPriority: "æ‰§è¡Œé¡ºåºå»ºè®®ä¸ºï¼šå…ˆè¡¥é½æ”¶å…¥ â†’ å†å¤„ç†å¤§é¢äº¤æ˜“å½’ç±» â†’ æœ€åæ¸…ç†è®¢é˜…ã€‚è¿™æ ·èƒ½ç¡®ä¿ç°é‡‘æµåº•ç›˜ç¨³å®šåå†åšç»“æ„è°ƒæ•´ã€‚",
        recordQuality: "è®°å½•ç²’åº¦å»ºè®®ä»ã€Œé‡‘é¢ã€å‡çº§åˆ°ã€Œç”¨é€” + æ˜¯å¦å¤å‘ + å¿…éœ€/å¯é€‰ã€ã€‚è¿™æ ·ç³»ç»Ÿèƒ½åŒºåˆ†ä¸€æ¬¡æ€§é‡‡è´­ä¸æŒç»­æ€§æ”¯å‡ºï¼Œç»“è®ºæ›´ç¨³å®šï¼Œä¹Ÿæ›´èƒ½æŒ‡å¯¼é¢„ç®—é…ç½®ã€‚",
        warningBox: "<strong>ğŸ’¡ å»ºè®®æ‰§è¡Œï¼š</strong> ä½ ç°åœ¨çš„è´¦å•é‡Œåªæœ‰æ”¯å‡ºï¼Œæ²¡æœ‰æ”¶å…¥ï¼ŒAI æ²¡æ³•ç®—å‡ºä½ çš„ã€Œè´¢åŠ¡å®‰å…¨æ„Ÿã€ã€‚å»ºè®®è®°ä¸€ç¬”æœ€è¿‘çš„å·¥èµ„ï¼Œçœ‹çœ‹ä½ çš„é’±èƒ½æ’‘å¤šä¹…ï¼Ÿ",
        
        // å›¾è¡¨æ•°æ®ï¼šæ ‘å›¾
        treeData: [
            { name: "å™¨ææŠ•èµ„ (æ‘„å½±)", value: 5600 },
            { name: "é¥®é£Ÿå¥åº· (çƒ­é£Ÿ)", value: 2800 },
            { name: "æŠ€èƒ½æ ‘ (å…¬å…±è¯¾)", value: 1200 },
            { name: "å›ºå®šæˆæœ¬ (æˆ¿ç§Ÿ/æ°´ç”µ)", value: 2500 },
            { name: "æ‹¿é“å› å­ (å°é¢è®¢é˜…)", value: 350 }
        ],
        
        // å›¾è¡¨æ•°æ®ï¼šé›·è¾¾å›¾1
        radar1Data: {
            indicators: [
                { name: "èŠ‚ä¿­ (Frugality)", max: 100 },
                { name: "ç¨³å®š (Stability)", max: 100 },
                { name: "å¤šå…ƒ (Diversified)", max: 100 },
                { name: "æŠ•èµ„ (Self-Invest)", max: 100 },
                { name: "å®‰å…¨ (Risk-Ctrl)", max: 100 }
            ],
            values: [65, 80, 45, 95, 88],
            name: "è´¢åŠ¡æ€§æ ¼"
        },
        
        // å›¾è¡¨æ•°æ®ï¼šé›·è¾¾å›¾3
        radar3Data: {
            indicators: [
                { name: "çœé’±æŒ‡æ•°", max: 100 },
                { name: "æ”¯å‡ºç¨³å®š", max: 100 },
                { name: "æŠ•èµ„è‡ªå·±", max: 100 },
                { name: "é£é™©æ„è¯†", max: 100 },
                { name: "é’±åŒ…æ·±åº¦", max: 100 }
            ],
            values: [95, 98, 70, 90, 30],
            name: "è´¢åŠ¡ç”»åƒ"
        }
    };

    // ==========================================================
    // å·¥å…·å‡½æ•°ï¼šæ ¼å¼åŒ–é‡‘é¢
    // ==========================================================
    function formatMoney(amount) {
        return "Â¥ " + amount.toLocaleString('zh-CN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    // ==========================================================
    // å·¥å…·å‡½æ•°ï¼šå®‰å…¨è®¾ç½®æ–‡æœ¬å†…å®¹
    // ==========================================================
    function setText(id, content) {
        const el = document.getElementById(id);
        if (el) el.innerHTML = content;
    }

    // ==========================================================
    // æ ¸å¿ƒå‡½æ•°ï¼šæ¸²æŸ“é¡µé¢æ•°æ®
    // ==========================================================
    function renderData(data) {
        // é¡µé¢å¤´éƒ¨å’Œåº•éƒ¨
        if (data.logoBase64) {
            document.getElementById("pageLogo").innerHTML = `<img src="${data.logoBase64}" alt="Logo" class="page-logo">`;
        } else {
            document.getElementById("pageLogo").innerHTML = '<span class="page-logo-emoji">ğŸ’°</span>';
        }
        if (data.pageHeaderTitle) {
            setText("pageHeaderTitle", data.pageHeaderTitle);
        }
        if (data.pageFooter) {
            setText("pageFooter", data.pageFooter);
        }
        
        // é¡µé¢æ ‡é¢˜å’Œæ ‡ç­¾
        setText("reportTitle", data.reportTitle);
        setText("healthScoreLabel", data.healthScoreLabel);
        setText("incomeLabel", data.incomeLabel);
        setText("expenseLabel", data.expenseLabel);
        setText("outlierLabel", data.outlierLabel);
        setText("outlierDesc", data.outlierDesc);
        
        // ç« èŠ‚æ ‡é¢˜
        setText("consumeTitle", data.consumeTitle);
        setText("radarTitle", data.radarTitle);
        setText("riskTitle", data.riskTitle);
        setText("behaviorTitle", data.behaviorTitle);
        setText("conclusionTitle", data.conclusionTitle);
        setText("actionTitle", data.actionTitle);
        setText("executionTitle", data.executionTitle);
        setText("recordQualityTitle", data.recordQualityTitle);
        
        // å­æ ‡é¢˜
        setText("preferenceSubtitle", data.preferenceSubtitle);
        setText("timePatternSubtitle", data.timePatternSubtitle);
        
        // å¤´éƒ¨ä¿¡æ¯
        setText("identityBadge", `èº«ä»½è¯†åˆ«ï¼š${data.identity}`);
        setText("headerDesc", data.headerDescription);
        setText("healthScore", data.healthScore);
        
        // æ ¸å¿ƒæŒ‡æ ‡
        setText("totalIncome", formatMoney(data.totalIncome));
        setText("savingsNote", `å‚¨è“„ç‡: ${data.savingsRate}% (${data.savingsStatus})`);
        setText("totalExpense", formatMoney(data.totalExpense));
        setText("maxSingleNote", `æœ€é«˜å•ç¬”: ${formatMoney(data.maxSingleAmount)} (${data.maxSingleCategory})`);
        setText("outlierIndex", `${data.outlierIndex}%`);
        
        // æ¶ˆè´¹ç»“æ„åˆ†æ
        setText("consumeAnalysis1", data.consumeAnalysis1);
        setText("consumeAnalysis2", data.consumeAnalysis2);
        
        // å¼‚å¸¸é£é™©åˆ†æ
        setText("outlierAnalysis", data.outlierAnalysis);
        setText("largeTransactionAnalysis", data.largeTransactionAnalysis);
        setText("latteFactorAnalysis", data.latteFactorAnalysis);
        
        // æ¶ˆè´¹ç”»åƒ
        setText("preferenceAnalysis", data.preferenceAnalysis);
        setText("timePatternAnalysis", data.timePatternAnalysis);
        
        // ç»¼åˆç»“è®º
        setText("conclusion1", data.conclusion1);
        setText("conclusion2", data.conclusion2);
        setText("expertSummary", data.expertSummary);
        
        // æ ‡ç­¾
        const tagRow = document.getElementById("tagRow");
        if (tagRow) {
            tagRow.innerHTML = data.tags.map(tag => 
                `<span class="tag tag-${tag.type}">${tag.text}</span>`
            ).join("");
        }
        
        // è¡ŒåŠ¨æ¸…å•
        setText("actionIntro", data.actionIntro);
        const actionList = document.getElementById("actionList");
        if (actionList) {
            actionList.innerHTML = data.actions.map(action => `<li>${action}</li>`).join("");
        }
        setText("executionPriority", data.executionPriority);
        setText("recordQuality", data.recordQuality);
        setText("warningBox", data.warningBox);
        
        // æ¸²æŸ“å›¾è¡¨
        renderCharts(data);
    }

    // ==========================================================
    // æ¸²æŸ“å›¾è¡¨
    // ==========================================================
    function renderCharts(data) {
        const rootStyles = getComputedStyle(document.documentElement);
        const cssVar = (name) => rootStyles.getPropertyValue(name).trim();
        const rgbaFromVar = (name, alpha) => `rgba(${cssVar(name)}, ${alpha})`;
        
        const chartColors = {
            primary: cssVar('--color-primary'),
            primaryRgb: '--color-primary-rgb',
            secondary: cssVar('--color-secondary'),
            success: cssVar('--color-success'),
            warning: cssVar('--color-warning'),
            primaryDark: cssVar('--color-primary-dark'),
            textSubtle: cssVar('--color-text-subtle'),
        };

        // æ ‘å›¾
        const treeOption = {
            series: [{
                type: 'treemap',
                data: data.treeData.map((item, idx) => ({
                    name: item.name,
                    value: item.value,
                    itemStyle: { 
                        color: [chartColors.primary, chartColors.success, chartColors.primaryDark, 
                                chartColors.secondary, chartColors.warning][idx % 5]
                    }
                }))
            }]
        };
        const treeChart = echarts.init(document.getElementById('treeChart1'));
        treeChart.setOption(treeOption);

        // é›·è¾¾å›¾1
        const radarOption1 = {
            radar: {
                indicator: data.radar1Data.indicators,
                axisName: { color: chartColors.secondary }
            },
            series: [{
                type: 'radar',
                data: [{
                    value: data.radar1Data.values,
                    name: data.radar1Data.name,
                    areaStyle: { color: rgbaFromVar(chartColors.primaryRgb, 0.4) },
                    lineStyle: { color: chartColors.primary }
                }]
            }]
        };
        const radarChart1 = echarts.init(document.getElementById('radarChart1'));
        radarChart1.setOption(radarOption1);

        // é›·è¾¾å›¾3
        const radarOption3 = {
            radar: {
                indicator: data.radar3Data.indicators,
                shape: 'circle',
                splitNumber: 4,
                axisName: { color: chartColors.textSubtle },
                splitLine: { lineStyle: { color: rgbaFromVar(chartColors.primaryRgb, 0.1) } },
                splitArea: { show: false }
            },
            series: [{
                type: 'radar',
                data: [{
                    value: data.radar3Data.values,
                    name: data.radar3Data.name,
                    itemStyle: { color: chartColors.primary },
                    areaStyle: { color: rgbaFromVar(chartColors.primaryRgb, 0.2) }
                }]
            }]
        };
        const radarChart3 = echarts.init(document.getElementById('radarChart3'));
        radarChart3.setOption(radarOption3);

        // å“åº”å¼å¤„ç†
        window.addEventListener('resize', () => {
            treeChart.resize();
            radarChart1.resize();
            radarChart3.resize();
        });
    }

    // ==========================================================
    // å¤–éƒ¨è°ƒç”¨æ¥å£ï¼šsetJson
    // ==========================================================
    function setJson(jsonData) {
        // åˆå¹¶ç”¨æˆ·æ•°æ®å’Œé»˜è®¤æ•°æ®
        const data = Object.assign({}, defaultData, jsonData);
        renderData(data);
    }

    // ==========================================================
    // é¡µé¢åˆå§‹åŒ–ï¼šä½¿ç”¨é»˜è®¤æ•°æ®æ¸²æŸ“
    // ==========================================================
    document.addEventListener('DOMContentLoaded', function() {
        renderData(defaultData);
    });

    // æš´éœ²æ¥å£åˆ°å…¨å±€
    window.setJson = setJson;
</script>
</body>
</html>
